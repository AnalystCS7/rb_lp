<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <record id="group_reward_manager" model="res.groups">
    <field name="name">Reward Manager</field>
    <field name="category_id" ref="base.module_category_hidden"/>
    <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
  </record>

  <record id="group_reward_user" model="res.groups">
    <field name="name">Reward User</field>
    <field name="category_id" ref="base.module_category_hidden"/>
    <field name="implied_ids" eval="[(4, ref('base.group_portal'))]"/>
  </record>

  <record id="model_reward_tier" model="ir.model">
    <field name="name">Reward Tier</field>
    <field name="model">reward.tier</field>
    <field name="state">manual</field>
    <field name="access_ids" eval="[(4,ref('access_reward_manager'))]"/>
  </record>

  <record id="model_reward_customer" model="ir.model">
    <field name="name">Reward Customer</field>
    <field name="model">reward.customer</field>
    <field name="state">manual</field>
    <field name="access_ids" eval="[(4,ref('access_reward_user'))]"/>
  </record>

  <record id="access_reward_manager" model="ir.rule">
    <field name="name">Access Reward Manager</field>
    <field name="model_id" ref="model_reward_tier"/>
    <field name="groups" eval="[(4, ref('group_reward_manager'))]"/>
    <field name="perm_read" eval="True"/>
    <field name="perm_write" eval="True"/>
    <field name="perm_create" eval="True"/>
    <field name="perm_unlink" eval="True"/>
  </record>

  <record id="access_reward_user" model="ir.rule">
    <field name="name">Access Reward User</field>
    <field name="model_id" ref="model_reward_customer"/>
    <field name="groups" eval="[(4, ref('group_reward_user'))]"/>
    <field name="perm_read" eval="True"/>
    <field name="perm_write" eval="True"/>
    <field name="perm_create" eval="True"/>
    <field name="perm_unlink" eval="True"/>
  </record>

  <!-- Customers can view their own rewards and points balance -->
  <record id="customer_rewards_access" model="ir.rule">
    <field name="name">Customer Rewards Access</field>
    <field name="model_id" ref="royal_rewards.model_customer"/>
    <field name="domain_force">[('id', '=', user.partner_id.reward_id.id)]</field>
    <field name="perm_read" eval="True"/>
    <field name="perm_write" eval="False"/>
    <field name="perm_create" eval="False"/>
    <field name="perm_unlink" eval="False"/>
  </record>

  <!-- Users who belong to the 'Loyalty Manager' group can view and edit all rewards data -->
  <record id="loyalty_manager_rewards_access" model="ir.rule">
    <field name="name">Loyalty Manager Rewards Access</field>
    <field name="model_id" ref="royal_rewards.model_reward"/>
    <field name="groups" eval="[(4, ref('royal_rewards.group_loyalty_manager'))]"/>
    <field name="perm_read" eval="True"/>
    <field name="perm_write" eval="True"/>
    <field name="perm_create" eval="True"/>
    <field name="perm_unlink" eval="True"/>
  </record>

  <!-- Users who belong to the 'Loyalty Manager' group can view and edit all transaction data -->
  <record id="loyalty_manager_transaction_access" model="ir.rule">
    <field name="name">Loyalty Manager Transaction Access</field>
    <field name="model_id" ref="royal_rewards.model_transaction"/>
    <field name="groups" eval="[(4, ref('royal_rewards.group_loyalty_manager'))]"/>
    <field name="perm_read" eval="True"/>
    <field name="perm_write" eval="True"/>
    <field name="perm_create" eval="True"/>
    <field name="perm_unlink" eval="True"/>
  </record>
</odoo>
